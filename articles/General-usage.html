<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>General usage • morphospace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="General usage">
<meta property="og:description" content="morphospace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>General usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/vignettes/General-usage.Rmd" class="external-link"><code>vignettes/General-usage.Rmd</code></a></small>
      <div class="hidden name"><code>General-usage.Rmd</code></div>

    </div>

    
    
<p><code>morphospace</code> has been built to work in intergration with
other widely used R packages covering other more essential steps in the
geometric morphometrics pipeline (e.g. importation, normalization,
statistical analysis) such as <code>Morpho</code> (Schlager 2017),
<code>geomorph</code> (Adams et al. 2021), <code>shapes</code> (Dryden
2019), and <code>Momocs</code> (Bonhome et al. 2014).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/millacarmona/morphospace" class="external-link">morphospace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<p>The basic idea behind <code>morphospace</code> is to build empirical
morphospaces using multivariate methods, then use the resulting
ordination as a reference frame in which elements representing different
aspects of morphometric variation can projected. This workflow is
outlined below using the <code>tails</code> data set from Fasanelli et
al. (2022), which contains a sample of tail shapes from the 13 species
of the genus <em>Tyrannus</em> (kingbirds and flycatchers). Two of these
(the flycatchers <em>T. savana</em> and <em>T. forficatus</em>) display
exaggeratedly elongated tails, as well as a considerable allometric
variation and sexual dimorphism. The <code>tails</code> data set
contains landmark data and centroid sizes from the tails of 281
specimens, their classification to species, sex and type (deep-forked,
DF or non deep-forked, NDF), and their phylogenetic relationships (see
Fasanelli et al. 2022 and references therein). The links between
landmarks have been also included to improve visualization.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load tail data and extract shapes, centroid sizes, classification of sex </span></span>
<span><span class="co"># and species, links between landmarks, and phylogenetic tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">tails</span><span class="op">$</span><span class="va">sizes</span><span class="op">)</span></span>
<span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">sex</span></span>
<span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span></span>
<span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></code></pre></div>
<div class="section level3">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h3>
<p>The starting point of this workflow is morphometric data that is
already free of differences in orientation, position and scale (this
standardization can be implemented using functions provided by the
aforementioned R packages). However, <code>morphospace</code> provide
some alternatives to perform some basic operations on shape data, such
as the calculation of mean shapes or the analytical removal of undesired
sources of variation (functions <code>expected_shapes</code> and
<code>detrend_shapes</code>, respectively). For example, we can to get
rid of sexual dimorphism before moving forward.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove variation associated with sexual dimorphism and compute the </span></span>
<span><span class="co"># consensus shape of each species</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">detr_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detrend_shapes.html">detrend_shapes</a></span><span class="op">(</span><span class="va">model</span>, method <span class="op">=</span> <span class="st">"residuals"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/arrayspecs.html" class="external-link">arrayspecs</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expected_shapes.html">expected_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, x <span class="op">=</span> <span class="va">spp</span><span class="op">)</span></span></code></pre></div>
<p>Once the shape data is ready, we build a morphospace using the
<code>mspace</code> function and then use the resulting ordination as a
canvas in which to project different elements depicting various aspects
of morphometric variation (scatter points, groups centroids, convex
hulls, confidence ellipses, a phylogeny, etc). These elements are added
both to the plot and the <code>"mspace"</code> object as consecutive
‘layers’ and list slots, respectively, using the <code>proj_*</code>
family of functions and the <code>%&gt;%</code> pipe operator from the
<code>magrittr</code> package (Bache &amp; Wickham 2022).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate morphospace using detrended shapes, project specimens</span></span>
<span><span class="va">msp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Morphospace"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Generate morphospace, project specimens and delimit species' ranges </span></span>
<span><span class="co"># of variation using convex hulls</span></span>
<span><span class="va">msp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Morphospace\n+ species differentiation"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-5-2.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Generate morphospace, project specimens, delimit groups of them </span></span>
<span><span class="co"># with convex hulls, project phylogenetic tree (requires a "phy" </span></span>
<span><span class="co"># object)</span></span>
<span><span class="va">msp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">phy</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Morphospace\n+ groups + phylogeny"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-5-3.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Check the elements projected in each mspace object, note the slots </span></span>
<span><span class="co"># corresponding to projected scores, groups classification and scores </span></span>
<span><span class="co"># included on each, the phylogenetic tree and scores for nodes and tips.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">msp1</span><span class="op">$</span><span class="va">projected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "shapemodels" "scores"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">msp2</span><span class="op">$</span><span class="va">projected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "shapemodels" "scores"      "gr_class"    "gr_scores"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">msp3</span><span class="op">$</span><span class="va">projected</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "shapemodels"  "scores"       "gr_class"     "gr_scores"    "phylo_scores"</span></span>
<span><span class="co">#&gt; [6] "phylo"</span></span></code></pre></div>
<p>Another potentially interesting element that can be projected into
morphospaces are morphometric axes or phenotypic change vectors,
i.e. synthetic axes built as linear combinations of shape variables that
describe a linear path across the morphospace. For example, we can
project the first two PC axes resulting from a PCA of NDF specimens data
into our morphospace.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># perform PCA of refined shape variables (for the subset of NDF species), create </span></span>
<span><span class="co"># morphospace, and project the first 2 axes from the former into the latter</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">detr_shapes</span><span class="op">[</span>,,<span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"NDF"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">phy</span>, pch.tips <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_axis.html">proj_axis</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">pca</span>, axis <span class="op">=</span> <span class="fl">1</span>, mag <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_axis.html">proj_axis</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">pca</span>, axis <span class="op">=</span> <span class="fl">2</span>, mag <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Morphospace\n+ PC1 and PC2 of NDF species projected"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>Finally, landscape surfaces intended to represent functional or
performance measurements can be projected as contour maps with
<code>proj_landscape</code>. These surfaces are interpolated using the
<code>akima</code> package (Akima &amp; Gebhardt 2022) from values
provided directly through the argument <code>X</code> and corresponding
to the shapes provided through the <code>shapes</code> argument, or
computed through the latter using an arbitrary function, provided using
the argument <code>FUN</code>.</p>
<p>These landscapes can be computed for either a region of the
morphospace from a sample of empirical shapes occupying that region
(“<em>empirical landscapes</em>”) or from the set of synthetic shapes
mapping morphometric variation in the background (“<em>theoretical
landscapes</em>”). For the latter case, leave
<code>shapes = NULL</code>; if values are been provided using
<code>X</code> these must have been computed beforehand and arranged in
the same order as the shape models in the background (that is, from left
to right and from bottom to top), which can be extracted using
<code>extract_shapes</code>. This last step is not necessary if
<code>FUN</code> is provided. A scalebar can be added using
<code>plot_mspace</code> and <code>scalebar = TRUE</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute lift/drag ratio for each tail in the data set</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MomX/Momocs/" class="external-link">Momocs</a></span><span class="op">)</span></span>
<span><span class="va">LDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">detr_shapes</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu">morphospace</span><span class="fu">:::</span><span class="va">computeLD</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use LDs values to project an empirical landscape</span></span>
<span><span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_landscape.html">proj_landscape</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, X <span class="op">=</span> <span class="va">LDs</span>, linear <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                 display <span class="op">=</span> <span class="st">"filled.contour"</span>, resolution <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># project theoretical landscape, this time using the argument FUN to run</span></span>
<span><span class="co"># the computeLD function through the set of background shape models</span></span>
<span><span class="va">mspl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_landscape.html">proj_landscape</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="cn">NULL</span>, FUN <span class="op">=</span> <span class="fu">morphospace</span><span class="fu">:::</span> <span class="va">computeLD</span>, linear <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                 display <span class="op">=</span> <span class="st">"contour"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># a scale bar can be added (and changes introduced) by regenerating the </span></span>
<span><span class="co"># "mspace" object with plot_mspace</span></span>
<span><span class="fu"><a href="../reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span><span class="va">mspl</span>, display.landsc <span class="op">=</span> <span class="st">"filled.contour"</span>, </span>
<span>            palette.landsc <span class="op">=</span> <span class="va">terrain.colors</span>, scalebar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-7-3.png" width="100%"></p>
<p>(<em>Note: using the</em> <code>FUN</code> <em>argument is the easy
way to do this, but it needs a function that can go through every shape
as stored in a 2-margin matrix in which each row is a shape and each
column is a shape descripor (e.g. the output from</em>
<code><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">geomorph::two.d.array</a></code><em>)</em>)</p>
</div>
<div class="section level3">
<h3 id="ordination-methods">Ordination methods<a class="anchor" aria-label="anchor" href="#ordination-methods"></a>
</h3>
<p>The default settings of <code>mspace</code> rely on the
<code>prcomp</code> function from the <code>stats</code> package to
build the synthetic morphometric space. However,
<code>morphospace</code> also provides functions for ‘supervised’
ordination, namely phylogenetic PCA (Revell 2009) (implemented through
the <code>phy_prcomp</code> function, which wraps <code>phyl.pca</code>
from <code>phytools</code>, Revell 2012), between-groups PCA
(<code>bg_prcomp</code> function), and both ordinary and phylgenetic
versions of Partial Least Squares (PLS) (<code>pls_shapes</code>
function [an user-friendly wrapper of <code>pls2b</code>, which is used
in the following chunk]). These have been styled/wrapped to share format
with <code>prcomp</code>, and both bgPCA and PLS functions allow for
leave-one-out cross-validation (LOOCV), which alleviates some spurious
patterns that arise when the number of variables exceeds the number of
samples (as it is common in geometric morphometric analyses; see Cardini
et al. 2019 and Cardini &amp; Polly 2020).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate 100 random normal distributions, and add an artificial classification </span></span>
<span><span class="co"># and an artificial covariate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">random_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">random_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Perform bgPCA on the set of random variables to look for the bgPCs maximizing </span></span>
<span><span class="co"># separation between artificial groups, with and without LOOCV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bgpca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bg_prcomp.html">bg_prcomp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">random_y</span>, groups <span class="op">=</span> <span class="va">class</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpca1</span><span class="op">$</span><span class="va">x</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="va">class</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hulls_by_group_2D.html">hulls_by_group_2D</a></span><span class="op">(</span><span class="va">bgpca1</span><span class="op">$</span><span class="va">x</span>, <span class="va">class</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"bgPCA\n without LOOCV"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bgpca2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bg_prcomp.html">bg_prcomp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">random_y</span>, groups <span class="op">=</span> <span class="va">class</span>, LOOCV <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpca2</span><span class="op">$</span><span class="va">x</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="va">class</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hulls_by_group_2D.html">hulls_by_group_2D</a></span><span class="op">(</span><span class="va">bgpca2</span><span class="op">$</span><span class="va">x</span>, <span class="va">class</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"bgPCA\n with LOOCV"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Perform PLS on the set of random variables to look for the PLS axis maximzing </span></span>
<span><span class="co"># covariation between them and the artificial covariate, with and without LOOCV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pls2b.html">pls2b</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">random_x</span>, y <span class="op">=</span> <span class="va">random_y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls1</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">pls1</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">pls1</span><span class="op">$</span><span class="va">yscores</span> <span class="op">~</span> <span class="va">pls1</span><span class="op">$</span><span class="va">xscores</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"PLS\n without LOOCV"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pls2b.html">pls2b</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">random_x</span>, y <span class="op">=</span> <span class="va">random_y</span>, LOOCV <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">pls2</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">$</span><span class="va">yscores</span> <span class="op">~</span> <span class="va">pls2</span><span class="op">$</span><span class="va">xscores</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"PLS\n with LOOCV"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-8-2.png" width="100%"></p>
<p>These methods can be used instead of regular PCA for building
morphospaces via the <code>FUN</code> and <code>...</code> arguments
(adding the argument <code>groups</code> for <code>bg_prcomp</code>,
<code>tree</code> for <code>phy_prcomp</code>, and <code>X</code> [and
potentially also a <code>tree</code>] for <code>pls_shapes</code>,
respectively) of the <code>mspace</code> function. The resulting
morphospace can be combined with the <code>proj_*</code> functions in
the same way as before.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Between group PCA - all species (invert both axes for easier comparison with </span></span>
<span><span class="co"># previous plots). We'll use plot_mspace to add a legend:</span></span>
<span><span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">detr_shapes</span>, FUN <span class="op">=</span> <span class="va">bg_prcomp</span>, LOOCV <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="va">spp</span>,</span>
<span>       links <span class="op">=</span> <span class="va">wf</span>, invax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, col <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span>legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Morphospace emphasizing interspecific variation"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Phylogenetic PCA for all species, adding projection of intrapspecific variation,</span></span>
<span><span class="co"># add legend</span></span>
<span><span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">sp_shapes</span>, FUN <span class="op">=</span> <span class="va">phy_prcomp</span>, tree <span class="op">=</span> <span class="va">phy</span>, links <span class="op">=</span> <span class="va">wf</span>,</span>
<span>       xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.15</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.15</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, col <span class="op">=</span> <span class="st">"black"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span>legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Phylogenetic morphospace + samples"</span>, cex.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="flexible-visualization">Flexible visualization<a class="anchor" aria-label="anchor" href="#flexible-visualization"></a>
</h3>
<p>Finally, <code>"mspace"</code> objects created using the
<code>mspace %&gt;% proj_*</code> pipeline can be regenerated/modified
with the <code>plot_mspace</code> function, which adds further graphical
flexibility. By plotting a <code>"mspace"</code> object using this
function we can regenerate an existing morphospace as it was created;
alternatively, we can select a different set of axes to plot, choose
other colors and symbols for points, groups, etc (or not), or add a
legend (see chunk above). In addition, this function also allow
combining morphometric axes with other non-shape variables to produce
‘hybrid’ morphospaces.</p>
<p>For example, PC1 can be plotted against size to explore allometric
patterns:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build morphospace first</span></span>
<span><span class="va">msp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspace.html">mspace</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">detr_shapes</span>, groups <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">phy</span>, col.tips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot PC1 against log-size, add legend</span></span>
<span><span class="fu"><a href="../reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span><span class="va">msp</span>, x <span class="op">=</span> <span class="va">sizes</span>, axes <span class="op">=</span> <span class="fl">1</span>, nh <span class="op">=</span> <span class="fl">6</span>, nv <span class="op">=</span> <span class="fl">6</span>, cex.ldm <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            col.points <span class="op">=</span> <span class="va">spp</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Log-size"</span>,</span>
<span>            legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>Or we can combine PC1 (or any other PC axis) with the phylogenetic
tree to create a phenogram:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot vertical phenogram using PC1, add a legend</span></span>
<span><span class="fu"><a href="../reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span><span class="va">msp</span>, y <span class="op">=</span> <span class="va">phy</span>, axes <span class="op">=</span> <span class="fl">1</span>, nh <span class="op">=</span> <span class="fl">6</span>, nv <span class="op">=</span> <span class="fl">6</span>, cex.ldm <span class="op">=</span> <span class="fl">4</span>, </span>
<span>            col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Time"</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="General-usage_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
<p>(<em>Note: that legend’ labels are taken from the factor provided in
the</em> <code>groups</code> <em>argument from</em>
<code>proj_groups</code><em>, whereas symbols and colors are taken
from</em> <code>proj_shapes</code> <em>and</em> <code>proj_groups</code>
<em>graphical parameters</em>)</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Adams D.C., Collyer M.L., Kaliontzopoulou A., &amp; Baken E.K.
(2021). <em>geomorph: Software for geometric morphometric analyses</em>.
R package version 4.0.2. <a href="https://cran.r-project.org/package=geomorph" class="external-link uri">https://cran.r-project.org/package=geomorph</a>.</p>
<p>Akima H., &amp; Gebhardt A. (2022). <em>akima: Interpolation of
Irregularly and Regularly Spaced Data</em>. R package version 0.6-3.4 <a href="https://CRAN.R-project.org/package=akima" class="external-link uri">https://CRAN.R-project.org/package=akima</a>.</p>
<p>Bache S.F., &amp; Wickham H. (2022). m<em>agrittr: A Forward-Pipe
Operator for R</em>. R package version 2.0.3. <a href="https://CRAN.R-project.org/package=magrittr" class="external-link uri">https://CRAN.R-project.org/package=magrittr</a>.</p>
<p>Bonhomme V., Picq S., Gaucherel C., &amp; Claude J. (2014).
<em>Momocs: Outline Analysis Using R</em>. Journal of Statistical
Software, 56(13), 1-24. <a href="http://www.jstatsoft.org/v56/i13/" class="external-link uri">http://www.jstatsoft.org/v56/i13/</a>.</p>
<p>Cardini A., O’Higgins P., &amp; Rohlf F.J. (2019). <em>Seeing
distinct groups where there are none: spurious patterns from
between-group PCA</em>. Evolutionary Biology, 46(4), 303-316. <a href="https://doi.org/10.1007/s11692-019-09487-5" class="external-link uri">https://doi.org/10.1007/s11692-019-09487-5</a>.</p>
<p>Cardini A., &amp; Polly P. D. (2020). <em>Cross-validated between
group PCA scatterplots: A solution to spurious group separation?</em>.
Evolutionary Biology, 47(1), 85-95. <a href="https://doi.org/10.1007/s11692-020-09494-x" class="external-link uri">https://doi.org/10.1007/s11692-020-09494-x</a>.</p>
<p>Dryden, I.L. (2019). <em>shapes: statistical shape analysis</em>. R
package version 1.2.5. <a href="https://CRAN.R-project.org/package=shapes" class="external-link uri">https://CRAN.R-project.org/package=shapes</a>.</p>
<p>Fasanelli M.N., Milla Carmona P.S., Soto I.M., &amp; Tuero, D.T.
(2022). <em>Allometry, sexual selection and evolutionary lines of least
resistance shaped the evolution of exaggerated sexual traits within the
genus</em> Tyrannus. Journal of Evolutionary Biology, in press. <a href="https://doi.org/10.1111/jeb.14000" class="external-link uri">https://doi.org/10.1111/jeb.14000</a>.</p>
<p>Revell, L.J. (2009). <em>Size-correction and principal components for
interspecific comparative studies</em>. Evolution, 63, 3258-3268 <a href="https://doi.org/10.1111/j.1558-5646.2009.00804.x" class="external-link uri">https://doi.org/10.1111/j.1558-5646.2009.00804.x</a>.</p>
<p>Revell, L.J. (2012). <em>phytools: An R package for phylogenetic
comparative biology (and other things)</em>. Methods in Ecology and
Evolution 3, 217-223. <a href="https://doi.org/10.1111/j.2041-210X.2011.00169.x" class="external-link uri">https://doi.org/10.1111/j.2041-210X.2011.00169.x</a>.</p>
<p>Schlager S. (2017). <em>Morpho and Rvcg - Shape Analysis in R</em>.
In Zheng G., Li S., Szekely G. (eds.), <em>Statistical Shape and
Deformation Analysis</em>, 217-256. Academic Press. <a href="https://doi.org/10.1016/B978-0-12-810493-4.00011-0" class="external-link uri">https://doi.org/10.1016/B978-0-12-810493-4.00011-0</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
