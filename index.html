<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Build, Visualize and Explore Morphospaces • morphospace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Build, Visualize and Explore Morphospaces">
<meta property="og:description" content="morphospace provide functions aimed at building, visualizing, and exploring multivariate 
    ordinations of shape data resulting from geometric morphometrics analyses. The package has been built 
    to integrate with other widely used R packages for geometric morphometrics data manipulation and 
    analysis.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="morphospace-">morphospace <img src="reference/figures/morphosp_hex.png" align="right" width="200"><a class="anchor" aria-label="anchor" href="#morphospace-"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of <code>morphospace</code> is to enhance representation and heuristic exploration of multivariate ordinations of shape data. This package can handle the most common types of shape data working in integration with other widely used R packages such as <code>Morpho</code> (Schlager 2017), <code>geomorph</code> (Adams et al. 2021), <code>shapes</code> (Dryden 2019), and <code>Momocs</code> (Bonhome et al. 2014), which cover other more essential steps in the geometric morphometrics pipeline (e.g. importation, normalization, statistical analysis).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>morphospace</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"millacarmona/morphospace"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="concept">Concept<a class="anchor" aria-label="anchor" href="#concept"></a>
</h2>
<p>The basic idea behind <code>morphospace</code> is to build empirical morphospaces using multivariate ordination methods, then use the resulting ordination as a reference frame in which elements representing different aspects of morphometric variation are projected. These elements are added to both graphic representations and objects as consecutive ‘layers’ and list slots, respectively, using the <code>%&gt;%</code> pipe operator from <code>magrittr</code> (Bache &amp; Wickham 2022).</p>
<p>The starting point of the <code>morphospace</code> workflow is a set of shapes (i.e. morphometric data that is already free of variation due to differences in orientation, position and scale). These are fed to the <code>mspace</code> function, which generates a morphospace using a variety of multivariate methods related to Principal Component Analysis. This general workflow is broadly outlined below using the <code>tails</code> data set from Fasanelli et al. (2022), which contains tail shapes from 281 specimens belonging to 13 species of the genus <em>Tyrannus</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/millacarmona/morphospace" class="external-link">morphospace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zarquon42b/Morpho" class="external-link">Morpho</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MomX/Momocs/" class="external-link">Momocs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl" class="external-link">rgl</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load tail data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span>
<span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span></span>
<span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span>
<span></span>
<span><span class="co"># Generate morphospace</span></span>
<span><span class="fu"><a href="reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<p>The ordination produced by <code>mspace</code> is used as a reference frame in which scatter points, convex hulls / confidence ellipses, a phylogeny, a set of morphometric axes or a landscape surface can be projected using the <code>proj_*</code> functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get mean shapes of each species</span></span>
<span><span class="va">spp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/expected_shapes.html">expected_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span>, x <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate morphospace and project:</span></span>
<span><span class="va">msp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mspace.html">mspace</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, links <span class="op">=</span> <span class="va">wf</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># scatter points</span></span>
<span>  <span class="fu"><a href="reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># convex hulls enclosing groups</span></span>
<span>  <span class="fu"><a href="reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, groups <span class="op">=</span> <span class="va">spp</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># phylogenetic relationships</span></span>
<span>  <span class="fu"><a href="reference/proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">spp_shapes</span>, tree <span class="op">=</span> <span class="va">phy</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>                 col.tips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>Once the <code>"mspace"</code> object has been created, the <code>plot_mspace</code> function can be used to either regenerate/modify the plot, add a legend, or to combine morphometric axes with other non-shape variables to produce ‘hybrid’ morphospaces. For example, PC1 can be plotted against size to explore allometric patterns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot PC1 against log-size, add legend</span></span>
<span><span class="fu"><a href="reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span><span class="va">msp</span>, x <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">sizes</span>, axes <span class="op">=</span> <span class="fl">1</span>, nh <span class="op">=</span> <span class="fl">6</span>, nv <span class="op">=</span> <span class="fl">6</span>, cex.ldm <span class="op">=</span> <span class="fl">4</span>, </span>
<span>            alpha.groups <span class="op">=</span> <span class="fl">0.5</span>, col.points <span class="op">=</span> <span class="va">spp</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>, </span>
<span>            phylo <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Log-size"</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>Or ordination axes could be combined with a phylogenetic tree to create a phenogram:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot vertical phenogram using PC1, add a legend</span></span>
<span><span class="fu"><a href="reference/plot_mspace.html">plot_mspace</a></span><span class="op">(</span><span class="va">msp</span>, y <span class="op">=</span> <span class="va">phy</span>, axes <span class="op">=</span> <span class="fl">1</span>, nh <span class="op">=</span> <span class="fl">6</span>, nv <span class="op">=</span> <span class="fl">6</span>, cex.ldm <span class="op">=</span> <span class="fl">4</span>, </span>
<span>            col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Time"</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p><code>morphospace</code> can also handle closed outlines (in the form of elliptic Fourier coefficients) and 3D landmark data, as shown below briefly using the <code>shells</code> and <code>shells3D</code> data sets:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"shells"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">shells</span><span class="op">$</span><span class="va">shapes</span></span>
<span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="va">shells</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span>
<span></span>
<span><span class="co"># Generate morphospace</span></span>
<span><span class="fu"><a href="reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">shapes</span>, mag <span class="op">=</span> <span class="fl">1</span>, nh <span class="op">=</span> <span class="fl">5</span>, nv <span class="op">=</span> <span class="fl">4</span>, bg.model <span class="op">=</span> <span class="st">"light gray"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, col <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, groups <span class="op">=</span> <span class="va">spp</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"shells3D"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">shapes</span></span>
<span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">mesh_meanspec</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">mesh_meanspec</span></span>
<span></span>
<span><span class="co"># Generate surface mesh template</span></span>
<span><span class="va">meanspec_shape</span> <span class="op">&lt;-</span> <span class="va">shapes</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/findMeanSpec.html" class="external-link">findMeanSpec</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">meanmesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Morpho/man/tps3d.html" class="external-link">tps3d</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mesh_meanspec</span>, </span>
<span>                  refmat <span class="op">=</span> <span class="va">meanspec_shape</span>, </span>
<span>                  tarmat <span class="op">=</span> <span class="fu"><a href="reference/expected_shapes.html">expected_shapes</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate morphospace</span></span>
<span><span class="fu"><a href="reference/mspace.html">mspace</a></span><span class="op">(</span><span class="va">shapes</span>, mag <span class="op">=</span> <span class="fl">1</span>, bg.model <span class="op">=</span> <span class="st">"gray"</span>, cex.ldm <span class="op">=</span> <span class="fl">0</span>, template <span class="op">=</span> <span class="va">meanmesh</span>, </span>
<span>       adj_frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, col <span class="op">=</span> <span class="va">spp</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/proj_groups.html">proj_groups</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, groups <span class="op">=</span> <span class="va">spp</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Preparing for snapshot: rotate mean shape to the desired orientation</span></span>
<span><span class="co">#&gt;  (don't close or minimize the rgl device).Press &lt;Enter&gt; in the console to continue:</span></span>
<span><span class="co">#&gt; This can take a few seconds...</span></span>
<span><span class="co">#&gt; DONE.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>Aside from working with these types of morphometric data, <code>morphospace</code> provides functions to perform some useful shape operations, use TPS interpolation of curves/meshes to improve visualizations, and supports a variety of multivariate methods (bgPCA, phylogenetic PCA, PLS, phylogenetic PLS) to produce ordinations. For these and other options and details, go to <a href="https://millacarmona.github.io/morphospace/articles/General-usage.html">General usage</a> and <a href="https://millacarmona.github.io/morphospace/articles/Worked-examples.html">Worked examples</a>.</p>
</div>
<div class="section level2">
<h2 id="update-1-august-2022">Update 1 (August 2022)<a class="anchor" aria-label="anchor" href="#update-1-august-2022"></a>
</h2>
<ul>
<li><p>Different behavior for <code>proj_shapes</code> (now replaces <code>mspace$x</code> with the actual scores being projected) and <code>proj_axis</code> (now adds one or more axes into an <code>mspace$shape_axis</code>).</p></li>
<li><p>New <code>ellipses_by_groups_2D</code> (uses <code><a href="https://rdrr.io/pkg/car/man/Ellipses.html" class="external-link">car::ellipse</a></code>) function as an option for <code>proj_groups</code> and <code>plot_mspace</code>.</p></li>
<li><p>Morphospaces without background shape models are now an option (for both <code>mspace</code> and <code>plot_mspace</code>).</p></li>
<li><p><code>plot_mspace</code> now regenerates the original mspace plot by default (<code>proj_*</code> functions were modified such that all the relevant graphical parameters are inherited downstream to <code>plot_mspace</code>), has further flexibility regarding hybrid morphospaces (<code>plot_phenogram</code> has been updated) and allows adding a legend (and some various bugs were fixed as well).</p></li>
<li><p>Univariate morphospaces and associated density distributions are now an option (all the <code>mspace</code> workflow functions have been modified accordingly, especially <code>proj_shapes</code> and <code>proj_groups</code>).</p></li>
<li><p><code>consensus</code> and <code>expected_shapes</code> have been merged in a single function (the name <code>expected_shapes</code> was retained as the former was clashing with <code><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">ape::consensus</a></code>), which can handle both factors and numerics.</p></li>
<li><p>Both <code>detrend_shapes</code> and <code>expected_shapes</code> can now calculate phylogenetically-corrected coefficients for interspecific data sets (Revell 2009).</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="update-2-august-2023">Update 2 (August 2023)<a class="anchor" aria-label="anchor" href="#update-2-august-2023"></a>
</h2>
<ul>
<li><p>The structure of <code>"mspace"</code> objects has been reorganized and now contain 3 main slots: <code>$ordination</code> (multivariate ordination details), <code>$projected</code> (elements added using <code>proj_*</code> functions) and <code>$plotinfo</code> (used for regeneration using <code>plot_mspace</code>). This has been complemented with a <code>print</code> method for the <code>"mspace"</code> class.</p></li>
<li><p>New <code>proj_landscape</code> function has been added to represent adaptive surfaces interpolated from functional or performance indices (although can be used for any numerical variable).</p></li>
<li><p><code>proj_consensus</code> has been removed.</p></li>
<li><p>New <code>extract_shapes</code> function for extracting synthetic shapes from <code>"mspace"</code> objects (background shape models, shapes along ordination axes, or specific coordinates selected interactively).</p></li>
<li><p>New <code>burnaby</code> function, implementing Burnaby’s approach for standardization of morphometric data by computing a shape subspace orthogonal to an arbitrary vector or variable</p></li>
<li><p>New <code>phyalign_comp</code> function, implementing Phylogenetically aligned component analysis, which finds the linear combination of variables maximizing covariation between trait variation and phylogenetic structure (Collyer &amp; Adams 2021). Still a work in progress.</p></li>
<li><p>Several internal adjustments have been introduced to the <code>mspace</code>, <code>proj_*</code> and <code>plot_mspace</code> functions in order to improve visualization and make the workflow more flexible.</p></li>
<li><p>Legends created using <code>plot_mspace</code> have been improved, and scale bars for interpreting landscapes have also been made available.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Adams D.C., Collyer M.L., Kaliontzopoulou A., &amp; Baken E.K. (2021). <em>geomorph: Software for geometric morphometric analyses</em>. R package version 4.0.2. <a href="https://cran.r-project.org/package=geomorph" class="external-link uri">https://cran.r-project.org/package=geomorph</a>.</p>
<p>Bache S.F., &amp; Wickham H. (2022). <em>magrittr: A Forward-Pipe Operator for R</em>. R package version 2.0.3. <a href="https://CRAN.R-project.org/package=magrittr" class="external-link uri">https://CRAN.R-project.org/package=magrittr</a>.</p>
<p>Bonhomme V., Picq S., Gaucherel C., &amp; Claude J. (2014). <em>Momocs: Outline Analysis Using R</em>. Journal of Statistical Software, 56(13), 1-24. <a href="http://www.jstatsoft.org/v56/i13/" class="external-link uri">http://www.jstatsoft.org/v56/i13/</a>.</p>
<p>Collyer, M. L., &amp; Adams, D. (2021). <em>Phylogenetically aligned component analysis</em>. Methods in Ecology and Evolution, 12(2), 359-372. <a href="https://doi.org/10.1111/2041-210X.13515" class="external-link uri">https://doi.org/10.1111/2041-210X.13515</a>.</p>
<p>Dryden, I.L. (2019). <em>shapes: statistical shape analysis</em>. R package version 1.2.5. <a href="https://CRAN.R-project.org/package=shapes" class="external-link uri">https://CRAN.R-project.org/package=shapes</a>.</p>
<p>Fasanelli M.N., Milla Carmona P.S., Soto I.M., &amp; Tuero, D.T. (2022). <em>Allometry, sexual selection and evolutionary lines of least resistance shaped the evolution of exaggerated sexual traits within the genus</em> Tyrannus. Journal of Evolutionary Biology, in press. <a href="https://doi.org/10.1111/jeb.14000" class="external-link uri">https://doi.org/10.1111/jeb.14000</a>.</p>
<p>Revell, L.J. (2009). <em>Size-correction and principal components for interspecific comparative studies</em>. Evolution, 63, 3258-3268 <a href="https://doi.org/10.1111/j.1558-5646.2009.00804.x" class="external-link uri">https://doi.org/10.1111/j.1558-5646.2009.00804.x</a>.</p>
<p>Schlager S. (2017). <em>Morpho and Rvcg - Shape Analysis in R</em>. In Zheng G., Li S., Szekely G. (eds.), <em>Statistical Shape and Deformation Analysis</em>, 217-256. Academic Press. <a href="https://doi.org/10.1016/B978-0-12-810493-4.00011-0" class="external-link uri">https://doi.org/10.1016/B978-0-12-810493-4.00011-0</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/millacarmona/morphospace/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/millacarmona/morphospace/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing morphospace</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pablo Milla Carmona <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0396-6244" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/millacarmona/morphospace/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/millacarmona/morphospace/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
