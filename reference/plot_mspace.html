<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot morphospaces and combine them with other variables — plot_mspace • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot morphospaces and combine them with other variables — plot_mspace"><meta property="og:description" content="Flexible representation of morphospaces, including their combination
with other variables or a phylogeny."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot morphospaces and combine them with other variables</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/mspace_workflow.R" class="external-link"><code>R/mspace_workflow.R</code></a></small>
    <div class="hidden name"><code>plot_mspace.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Flexible representation of morphospaces, including their combination
with other variables or a phylogeny.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_mspace</span><span class="op">(</span></span>
<span>  <span class="va">mspace</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  links <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">nh</span>,</span>
<span>  <span class="va">nv</span>,</span>
<span>  <span class="va">mag</span>,</span>
<span>  invax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adj_frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  models <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mshapes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  phylo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  shapeax <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.legend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  asp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">xlab</span>,</span>
<span>  <span class="va">ylab</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">size.models</span>,</span>
<span>  <span class="va">asp.models</span>,</span>
<span>  <span class="va">rot.models</span>,</span>
<span>  <span class="va">col.models</span>,</span>
<span>  <span class="va">bg.models</span>,</span>
<span>  <span class="va">lwd.models</span>,</span>
<span>  <span class="va">alpha.models</span>,</span>
<span>  <span class="va">cex.ldm</span>,</span>
<span>  <span class="va">col.ldm</span>,</span>
<span>  pch.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  density.points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.groups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.groups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch.groups <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  cex.groups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ellipse.groups <span class="op">=</span> <span class="va">mspace</span><span class="op">$</span><span class="va">plotinfo</span><span class="op">$</span><span class="va">ellipse.groups</span>,</span>
<span>  conflev.groups <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  lwd.groups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty.groups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha.groups <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  density.groups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lwd.phylo <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty.phylo <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.phylo <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lwd.axis <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty.axis <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.axis <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mspace</dt>
<dd><p>An <code>"mspace"</code> object created using <code><a href="mspace.html">mspace()</a></code>.</p></dd>


<dt>axes</dt>
<dd><p>Numeric of length 1 or 2, indicating the axes to be plotted.</p></dd>


<dt>links</dt>
<dd><p>A list with the indices of the coordinates defining the
wireframe (following the format used in <code>Morpho</code>).</p></dd>


<dt>template</dt>
<dd><p>Either a 2-column matrix containing landmarks/semilandmarks
followed by coordinates defining a curve or set of curves describing additional
aspects of morphology (for 2D shape data) or a <code>"mesh3d"</code> object containing
geometry of the structure the landmarks were placed on (for 3D shape data),
corresponding to the mean shape of the sample. These will be warped using TPS
interpolation to produce the set of background shell models (see
<code><a href="build_template2d.html">build_template2d</a></code>).</p></dd>


<dt>x</dt>
<dd><p>Optional vector with a non-morphometric variable to be plotted in
the x axis. Alternatively, a <code>"phylo"</code> object can be provided.</p></dd>


<dt>y</dt>
<dd><p>Optional vector with a non-morphometric variable to be plotted in
the y axis. Alternatively, a <code>"phylo"</code> object can be provided.</p></dd>


<dt>nh</dt>
<dd><p>Numeric; the number of shape models along the x axis.</p></dd>


<dt>nv</dt>
<dd><p>Numeric; the number of shape models along the y axis.</p></dd>


<dt>mag</dt>
<dd><p>Numeric; magnifying factor for shape models.</p></dd>


<dt>invax</dt>
<dd><p>Optional numeric indicating which of the axes provided in
<code>axes</code> needs to be inverted (optionsare <code>1</code>, <code>2</code> or
<code>c(1,2)</code>).</p></dd>


<dt>adj_frame</dt>
<dd><p>Numeric of length 2, providing <em>a posteriori</em> scaling
factors for the width and height of the frame, respectively.</p></dd>


<dt>points</dt>
<dd><p>Logical; whether to plot the scatter points corresponding to
the sampled shapes stored in <code>mspace$x</code>.</p></dd>


<dt>models</dt>
<dd><p>Logical; whether to plot background shape models.</p></dd>


<dt>mshapes</dt>
<dd><p>Logical; whether to plot the scatter points corresponding to
groups' mean shapes stored in <code>mspace$gr_centroids</code>.</p></dd>


<dt>groups</dt>
<dd><p>Logical; whether to plot the convex hulls/confidence ellipses
enclosing the groups stored in <code>mspace$gr_class</code>.</p></dd>


<dt>phylo</dt>
<dd><p>Logical; whether to plot phylogenetic relationships stored
in <code>mspace$phylo</code>.</p></dd>


<dt>shapeax</dt>
<dd><p>Logical; whether to plot morphometric axes stored in
<code>mspace$shape_axis</code>.</p></dd>


<dt>legend</dt>
<dd><p>Logical; whether to show legend for groups (<code>mspace$gr_class</code>).</p></dd>


<dt>cex.legend</dt>
<dd><p>Numeric; size of legend labels/symbols.</p></dd>


<dt>xlim, ylim, xlab, ylab, asp</dt>
<dd><p>Standard arguments passed to the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot()</a></code>
function.</p></dd>


<dt>size.models</dt>
<dd><p>Numeric; size factor for shape models.</p></dd>


<dt>asp.models</dt>
<dd><p>Numeric; y/x aspect ratio of shape models.</p></dd>


<dt>rot.models</dt>
<dd><p>Numeric; angle (in degrees) to rotate shape models.</p></dd>


<dt>col.models</dt>
<dd><p>Color for wireframes/outlines.</p></dd>


<dt>bg.models</dt>
<dd><p>Background color for outlines/meshes.</p></dd>


<dt>lwd.models</dt>
<dd><p>Numeric; width of the lines in wireframes/outlines.</p></dd>


<dt>alpha.models</dt>
<dd><p>Numeric; transparency factor for background models (3D only).</p></dd>


<dt>cex.ldm</dt>
<dd><p>Numeric; size of landmarks/semilandmarks in the background
models.</p></dd>


<dt>col.ldm</dt>
<dd><p>Color of landmarks/semilandmarks in the background models.</p></dd>


<dt>pch.points</dt>
<dd><p>Numeric; symbol of the scatter points corresponding to
sampled shapes.</p></dd>


<dt>col.points</dt>
<dd><p>Color of the scatter points corresponding to sampled
shapes.</p></dd>


<dt>bg.points</dt>
<dd><p>Background color of the scatter points corresponding
to sampled shapes.</p></dd>


<dt>cex.points</dt>
<dd><p>Numeric; size of the scatter points corresponding to
sampled shapes.</p></dd>


<dt>density.points</dt>
<dd><p>Logical; whether to add density distribution for points
(univariate ordinations only).</p></dd>


<dt>col.groups</dt>
<dd><p>Color of the hulls/ellipses and/or scatter points corresponding
to groups mean shapes.</p></dd>


<dt>bg.groups</dt>
<dd><p>Background color of the scatter points corresponding
to groups mean shapes.</p></dd>


<dt>pch.groups</dt>
<dd><p>Numeric; symbol of the scatter points corresponding to
groups mean shapes.</p></dd>


<dt>cex.groups</dt>
<dd><p>Numeric; size of the scatter points corresponding to
groups mean shapes.</p></dd>


<dt>ellipse.groups</dt>
<dd><p>Logical; whether to plot confidence ellipses (if <code>FALSE</code>,
convex hulls will be used instead).</p></dd>


<dt>conflev.groups</dt>
<dd><p>Numeric; confidence level used for confidence ellipse(s).</p></dd>


<dt>lwd.groups</dt>
<dd><p>Numeric; width of the lines in groups' ellipses/hulls.</p></dd>


<dt>lty.groups</dt>
<dd><p>Numeric; type of the lines in groups' ellipses/hulls.</p></dd>


<dt>alpha.groups</dt>
<dd><p>Numeric; transparency factor for groups' ellipses/hulls/density
distributions.</p></dd>


<dt>density.groups</dt>
<dd><p>Logical; whether to add density distribution for groups
(univariate ordinations only).</p></dd>


<dt>lwd.phylo</dt>
<dd><p>Numeric; width of the lines depicting phylogenetic
branches.</p></dd>


<dt>lty.phylo</dt>
<dd><p>Numeric; type of the lines depicting phylogenetic branches.</p></dd>


<dt>col.phylo</dt>
<dd><p>Numeric; color of the lines depicting phylogenetic branches.</p></dd>


<dt>lwd.axis</dt>
<dd><p>Numeric; width of the lines depicting morphometric axis.</p></dd>


<dt>lty.axis</dt>
<dd><p>Numeric; type of the lines depicting  morphometric axis.</p></dd>


<dt>col.axis</dt>
<dd><p>Numeric; color of the lines depicting morphometric axis.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function allows to regenerate morphospaces contained in <code>mspace</code>
objects already in existence, either preserving the graphical attributes used
during the pipeline or modifying one or more of them (so there is no need to
execute the pipeline every time morphospaces need to be visualized and/or changed).</p>
<p>Also, <code>plot_mspace</code> expands the range of graphical options available
beyond 'pure' morphospaces. If a numeric non-shape variable (assumed to have
been measured for the same specimens in <code>mspace$x</code>) is feeded to one of
<code>x</code> or <code>y</code>, a 'hybrid' morphospace is produced (i.e. the bivariate
plot will be constructed from the combination of <code>x</code> or <code>y</code> and a
morphometric axis; shape models in the background will represent variation
only for the latter). If instead a <code>"phylo"</code> object (assumed to describe
the phylogenetic relationships among tips scores stored in
<code>mspace$phylo_scores</code>) is feeded to one of <code>x</code> or <code>y</code>, a vertical
or horizontal phenogram will be deployed (the x/y axis range will correspond to
branch lengths, so caution should be exercised when interpreting the output).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#load and extract relevant data, packages and information</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span></span>
<span class="r-in"><span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">sizes</span></span></span>
<span class="r-in"><span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span><span class="va">shapes</span>, <span class="va">species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">sizes</span>, <span class="va">species</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></span>
<span class="r-in"><span><span class="va">links</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate basic morphospace, add sampled shapes, species mean shapes, species</span></span></span>
<span class="r-in"><span><span class="co">#classification, and phylogenetic structure</span></span></span>
<span class="r-in"><span><span class="va">msp</span> <span class="op">&lt;-</span> <span class="fu"><a href="mspace.html">mspace</a></span><span class="op">(</span><span class="va">shapes</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="proj_shapes.html">proj_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="proj_consensus.html">proj_consensus</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="proj_groups.html">proj_groups</a></span><span class="op">(</span>groups <span class="op">=</span> <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot.xy(xy.coords(x, y), type = type, ...):</span> plot.new has not been called yet</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Plotting 'pure' morphospaces:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot mspace object as it is</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#add colors for points, by species</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#add links</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, links <span class="op">=</span> <span class="va">links</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#change number and sizes of shape models in the background</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, size.models <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#magnify deformation and highlight landmarks</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, size.models <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, col.ldm <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#change axes 1,2 for 1,3</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, size.models <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, col.ldm <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#represent ranges and centroids of groups</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, size.models <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, col.ldm <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">TRUE</span>, mshapes <span class="op">=</span> <span class="cn">TRUE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#add phylogeny</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, size.models <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>            col.points <span class="op">=</span> <span class="va">species</span>, col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, cex.ldm <span class="op">=</span> <span class="fl">5</span>, col.ldm <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">TRUE</span>, mshapes <span class="op">=</span> <span class="cn">TRUE</span>, phylo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Plotting 'hybrid' morphospaces:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot size against first PC</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, x <span class="op">=</span> <span class="va">sizes</span>,  axes <span class="op">=</span> <span class="fl">1</span>, links <span class="op">=</span> <span class="va">links</span>, col.points <span class="op">=</span> <span class="va">species</span>,</span></span>
<span class="r-in"><span>            col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, pch.points <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Centroid size"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Plotting phenograms:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot horizontal phenogram against PC1</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, x <span class="op">=</span> <span class="va">tree</span>,  axes <span class="op">=</span> <span class="fl">1</span>, links <span class="op">=</span> <span class="va">links</span>, col.points <span class="op">=</span> <span class="va">species</span>,</span></span>
<span class="r-in"><span>            col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, pch.points <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Branch lengths"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot horizontal phenogram against PC1</span></span></span>
<span class="r-in"><span><span class="fu">plot_mspace</span><span class="op">(</span><span class="va">msp</span>, y <span class="op">=</span> <span class="va">tree</span>,  axes <span class="op">=</span> <span class="fl">2</span>, links <span class="op">=</span> <span class="va">links</span>, col.points <span class="op">=</span> <span class="va">species</span>,</span></span>
<span class="r-in"><span>            col.groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, pch.points <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>            points <span class="op">=</span> <span class="cn">TRUE</span>, groups <span class="op">=</span> <span class="cn">FALSE</span>, mshapes <span class="op">=</span> <span class="cn">FALSE</span>, phylo <span class="op">=</span> <span class="cn">FALSE</span>, ylab <span class="op">=</span> <span class="st">"Branch lengths"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'msp' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

