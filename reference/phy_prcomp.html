<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phylogenetic Principal Component Analysis — phy_prcomp • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic Principal Component Analysis — phy_prcomp"><meta property="og:description" content="A wrapper for phytools::phyl.pca()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phylogenetic Principal Component Analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/multivariate_analyses.R" class="external-link"><code>R/multivariate_analyses.R</code></a></small>
    <div class="hidden name"><code>phy_prcomp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper for <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">phy_prcomp</span><span class="op">(</span><span class="va">x</span>, <span class="va">tree</span>, corr <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows. Row must be named and match tip labels from the phylogenetic
<code>tree</code>.</p></dd>


<dt>tree</dt>
<dd><p>A <code>"phylo"</code> object containing a phylogenetic tree. Tip
labels should match the row names from <code>x</code>.</p></dd>


<dt>corr</dt>
<dd><p>Logical; whether to use correlation instead of covariance matrix
as input.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>"phy_prcomp"</code> object formatted following the <code>"prcomp"</code></p>


<p>class:</p><ul><li><p><code>$x:</code> a matrix with the scores of observations in the new
ordination axes.</p></li>
<li><p><code>$values:</code> singular values from the SVD of the phylogenetic
rate matrix.</p></li>
<li><p><code>$rotation:</code> a matrix of eigenvector coefficients.</p></li>
<li><p><code>$center:</code> the phylogenetic mean (i.e., the shape estimated
for the root of the tree).</p></li>
<li><p><code>$totvar:</code> the sum of the variances of the original data.</p></li>
<li><p><code>$lambda, $logL:</code> fitted value of lambda and log-likelihood
of the model; see <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phyl.pca</a></code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Phylogenetic PCA finds the linear combination of variables (in
the context of <code>morphospace</code> will generally be a series of shapes
arranged as 2-margin matrix) maximizing the residual variation left after
removing covariation explained by phylogenetic history (i.e., they reflect
the covariance that would correspond to a star phylogeny), assuming a
Brownian model of evolution.</p>
<p>Phylogenetic PCA has some important differences relative to regular PCA.
First, the resulting ordination is centered around the phylogenetic mean
(i.e., the values estimated for the root of the tree) instead of the
overall centroid of the original variables. More importantly, both
phylogenetic PCA's eigenvectors and eigenvalues have been constructed using
covariation that is independent of phylogenetic structure. However, only
the orientation of the scores on those axes, and not their variances,
reflect this adjustment. In other words, orientation of the phylogenetic
PC axes are devoid of phylogenetic structure, but magnitudes measured in
the resulting morphospace (e.g. distances, variances) still retain
phylogenetic information.</p>
<p>Because of these properties, eigenvalues and variances computed from
phylogenetic PC scores will differ. The former represents the amount of
variation among the taxa after removing covariance accounted by phylogeny
-- although their magnitude depends on the units used to measure
branch length, and thus cannot be simply interpreted as a proportion of the
original variance. Also, variance computed from pPC scores do not
necessarily decrease for lower axes, and are not uncorrelated, meaning they
can contain redundant information. For more details on the difference
between phylogenetic and regular PCA, see Polly et al. 2013.</p>
<p>Like PCA, phylogenetic PCA does not change the dimensionality of the shape
data set -- the number of resulting pPC axes will be be equal to the
number of original variables (unless this is higher than the number of
observations, in which case the number of resulting pPC will be equal
to the latter).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Revell, L. J. (2009). <em>Size-correction and principal components for
interspecific comparative studies</em>. Evolution, 63, 3258-3268.</p>
<p>Polly, P. D., Lawing, A. M., Fabre, A. C., &amp; Goswami, A. (2013).
<em>Phylogenetic principal components analysis and geometric
morphometrics</em>. Hystrix, 24(1), 33-41.</p>
<p>Monteiro, L. R. (2013). <em>Morphometrics and the comparative method:
studying the evolution of biological shape</em>. Hystrix, the Italian Journal
of Mammalogy, 24(1), 25-32.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phyl.pca</a></code>, <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>,
<code><a href="exp_var.html">exp_var</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#load data and packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compute mean shapes for all species and extract the phylogenetic tree</span></span></span>
<span class="r-in"><span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span>, x <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#perform phylogenetic PCA</span></span></span>
<span class="r-in"><span><span class="va">ppca</span> <span class="op">&lt;-</span> <span class="fu">phy_prcomp</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">sp_shapes</span><span class="op">)</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#inspect results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppca</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "values"   "rotation" "x"        "center"  </span>
<span class="r-in"><span><span class="co">#exp_var(ppca) ##interpretation of eigenvalues is complex! not yet implemented</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="phy_prcomp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare shape variation as summarized by different methods</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#build morphospace using phylogenetic PCA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mspace.html">mspace</a></span><span class="op">(</span><span class="va">sp_shapes</span>, links <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span>, nh <span class="op">=</span> <span class="fl">8</span>, nv <span class="op">=</span> <span class="fl">6</span>, FUN <span class="op">=</span> <span class="va">phy_prcomp</span>,</span></span>
<span class="r-in"><span>       tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span><span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="phy_prcomp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare against morphospace built with ordinary PCA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mspace.html">mspace</a></span><span class="op">(</span><span class="va">sp_shapes</span>, links <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span>, nh <span class="op">=</span> <span class="fl">8</span>, nv <span class="op">=</span> <span class="fl">6</span>, invax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span><span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="phy_prcomp-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

