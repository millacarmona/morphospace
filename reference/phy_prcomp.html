<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A wrapper for phytools::phyl.pca()."><title>Phylogenetic Principal Component Analysis — phy_prcomp • morphospace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic Principal Component Analysis — phy_prcomp"><meta property="og:description" content="A wrapper for phytools::phyl.pca()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">morphospace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/General-usage.html">General usage</a>
    <a class="dropdown-item" href="../articles/Worked-examples.html">Worked examples</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/millacarmona/morphospace/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Phylogenetic Principal Component Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/multivariate_analyses.R" class="external-link"><code>R/multivariate_analyses.R</code></a></small>
      <div class="d-none name"><code>phy_prcomp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A wrapper for <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">phy_prcomp</span><span class="op">(</span><span class="va">x</span>, <span class="va">tree</span>, corr <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows. Row must be named and match tip labels from the phylogenetic
<code>tree</code>.</p></dd>
<dt>tree</dt>
<dd><p>A <code>"phy"</code> object containing a phylogenetic tree. Tip labels
should match the row names from <code>x</code>.</p></dd>
<dt>corr</dt>
<dd><p>Logical; whether to use correlation instead of covariance matrix
as input.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>"phy_prcomp"</code> object formatted following the <code>"prcomp"</code>class:</p><ul><li><p><code>$sdev:</code> the standard deviations of the principal components
(i.e. the square roots of the eigenvalues of the covariance/correlation
matrix).</p></li>
<li><p><code>$rotation:</code> a matrix of eigenvector coefficients.</p></li>
<li><p><code>$center:</code> the phylogenetic mean (i.e. the shape estimated
for the root of the tree).</p></li>
<li><p><code>$totvar:</code> the sum of the variances from all the original
variables.</p></li>
<li><p><code>$lambda, $logL:</code> fitted value of lambda and log-likelihood
of the model; see <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phyl.pca</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Phylogenetic PCA finds the linear combination of variables (in the
the context of <code>morphospace</code> will generally be a series of shapes
arranged as 2-margin matrix) maximizing the residual variation left after
removing covariation explained by phylogenetic history (i.e. they reflect
the covariance that would correspond to a star phylogeny).</p>
<p>Phylogenetic PCA has some important differences to regular PCA. First, the
resulting ordination is centered around the phylogenetic mean (i.e. the
values estimated for the root of the tree) instead of the overall centroid
of the original variables. More importantly, both phylogenetic PCA's
eigenvectors and eigenvalues have been constructed using covariation that
is independent of phylogenetic structure. However, only the orientation of
the scores on those axes, and not their variances, reflect this adjustment.
In other words, orientation of the phylogenetic PC axes are devoid of
phylogenetic structure, but magnitudes measured in the resulting morphospace
(e.g. distances, variances) still retain phylogenetic information. Stemming
from this same fact, the variances computed using phylogenetic scores differ
from the ones calculated from the phylogenetic eigenvalues (which represent
the total amount of variance among the taxa after removing covariance
accounted by phylogeny, although their magnitude depends on the units used
to measure branch length), and do not necessarily decrease for subordinate
axes. Also, the set of phylogenetic scores are not uncorrelated, meaning
they can contain redundant information. For more details, see Polly et al.
2013.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Revell, L. J. (2009). <em>Size-correction and principal components
for interspecific comparative studies</em>. Evolution, 63, 3258-3268.</p>
<p>Polly, P. D., Lawing, A. M., Fabre, A. C., &amp; Goswami, A. (2013).
<em>Phylogenetic principal components analysis and geometric
morphometrics</em>. Hystrix, 24(1), 33-41.</p>
<p>Monteiro, L. R. (2013). <em>Morphometrics and the comparative method:
studying the evolution of biological shape</em>. Hystrix, the Italian Journal
of Mammalogy, 24(1), 25-32.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phyl.pca</a></code>, <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>,
<code><a href="exp_var.html">exp_var</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#load data and packages</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#compute mean shapes for all species and extract the phylogenetic tree</span></span>
<span class="r-in"><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="consensus.html">consensus</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span>, index <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#perform phylogenetic PCA</span></span>
<span class="r-in"><span class="va">ppca</span> <span class="op">&lt;-</span> <span class="fu">phy_prcomp</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">sp_shapes</span><span class="op">)</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#look at the results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppca</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sdev"     "rotation" "x"        "center"   "totvar"  </span>
<span class="r-in"><span class="fu"><a href="exp_var.html">exp_var</a></span><span class="op">(</span><span class="va">ppca</span><span class="op">)</span> <span class="co">#variance explained by each axis</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         variance cummulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC1  75.67476    75.67476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC2  21.40326    97.07802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC3   1.85156    98.92957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC4   0.79018    99.71975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC5   0.25384    99.97359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC6   0.02137    99.99496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC7   0.00504   100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC8   0.00000   100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC9   0.00000   100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC10  0.00000   100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC11  0.00000   100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPC12  0.00000   100.00000</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span>
<span class="r-plt img"><img src="phy_prcomp-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

