<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot background 3D shape models — plot_morphogrid3d • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot background 3D shape models — plot_morphogrid3d"><meta property="og:description" content="Plot the output from morphogrid(), for 3-dimensional morphometric
(landmark) data. Used internally."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot background 3D shape models</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/internal_builders.R" class="external-link"><code>R/internal_builders.R</code></a></small>
    <div class="hidden name"><code>plot_morphogrid3d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot the output from <code><a href="morphogrid.html">morphogrid()</a></code>, for 3-dimensional morphometric
(landmark) data. Used internally.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_morphogrid3d</span><span class="op">(</span>
  x <span class="op">=</span> <span class="cn">NULL</span>,
  y <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">morphogrid</span>,
  <span class="va">refshape</span>,
  template <span class="op">=</span> <span class="cn">NULL</span>,
  links <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">ordtype</span>,
  <span class="va">axes</span>,
  xlim <span class="op">=</span> <span class="cn">NULL</span>,
  ylim <span class="op">=</span> <span class="cn">NULL</span>,
  xlab <span class="op">=</span> <span class="cn">NULL</span>,
  ylab <span class="op">=</span> <span class="cn">NULL</span>,
  adj_frame <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">cex.ldm</span>,
  <span class="va">col.ldm</span>,
  <span class="va">col.models</span>,
  <span class="va">lwd.models</span>,
  <span class="va">size.models</span>,
  alpha.models <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">bg.models</span>,
  <span class="va">asp.models</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Optional vector with a non-morphometric variable to be plotted in
the x axis.</p></dd>
<dt>y</dt>
<dd><p>Optional vector with a non-morphometric variable to be plotted in
the y axis.</p></dd>
<dt>morphogrid</dt>
<dd><p>An object containing the output of <code>morphogrid</code>.</p></dd>
<dt>refshape</dt>
<dd><p>reference shape (i.e., the mean landmark configuration)
corresponding to the mesh provided in <code>template</code>.</p></dd>
<dt>template</dt>
<dd><p>An optional <code>"mesh3d"</code> object containing
geometry of the structure the landmarks were placed on (for 3D shape data),
corresponding to the mean shape of the sample, which will be warped using
TPS interpolation to produce the set of background shell models.</p></dd>
<dt>links</dt>
<dd><p>A list with the indices of the coordinates defining the
wireframe (following the format used in <code>Morpho</code>).</p></dd>
<dt>ordtype</dt>
<dd><p>Character; method used for multivariate ordination
(<code>"prcomp"</code>, <code>"bg_prcomp"</code>, <code>"phy_prcomp"</code>, <code>"pls_shapes"</code>
or <code>"phy_pls_shapes"</code>).</p></dd>
<dt>axes</dt>
<dd><p>Numeric of length 2, indicating the axes to be plotted.</p></dd>
<dt>xlim, ylim, xlab, ylab</dt>
<dd><p>Standard arguments passed to the generic plot
function.</p></dd>
<dt>adj_frame</dt>
<dd><p>Numeric of length 2, providing <em>a posteriori</em> scaling
factors for the width and height of the frame, respectively.</p></dd>
<dt>cex.ldm</dt>
<dd><p>Numeric; size of landmarks/semilandmarks in the background
models.</p></dd>
<dt>col.ldm</dt>
<dd><p>The color of landmarks/semilandmarks in the background models.</p></dd>
<dt>col.models</dt>
<dd><p>The color for wireframes/outlines.</p></dd>
<dt>lwd.models</dt>
<dd><p>Numeric; the width of the lines in wireframes/outlines.</p></dd>
<dt>size.models</dt>
<dd><p>Numeric; size factor for shape models.</p></dd>
<dt>alpha.models</dt>
<dd><p>Numeric; transparency factor for background models.</p></dd>
<dt>bg.models</dt>
<dd><p>Background color for meshes.</p></dd>
<dt>asp.models</dt>
<dd><p>Numeric; the y/x aspect ratio of shape models.</p></dd>
<dt>plot</dt>
<dd><p>Logical; whether to plot morphospace.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function allows the user to choose the orientation of the 3D
models by interactively rotating a shape model. Do not close the <code>rgl</code>
window, or minimize it actively (just bring back Rstudio to the front and
let the device get minimized pasively). The process of morphospace generation
is rather slow, specially if a mesh is provided for <code>template</code>, a large
number of shape models is asked, and/or <code>alpha.models</code> value is lower
than <code>1</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="morphogrid.html">morphogrid</a></code>, <code><a href="adjust_models3d.html">adjust_models3d</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#load data and packages</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"shells3D"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">shapes</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#perform pca on tails shapes</span></span>
<span class="r-in"><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#generate grid of shape models sampling the range of variation</span></span>
<span class="r-in"><span class="co">#at 4 locations (the 4 corners of the scatterplot)</span></span>
<span class="r-in"><span class="va">shapes_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="morphogrid.html">morphogrid</a></span><span class="op">(</span>ordination <span class="op">=</span> <span class="va">pca</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, datype <span class="op">=</span> <span class="st">"landm"</span>,</span>
<span class="r-in">                          k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span>,</span>
<span class="r-in">                          nh <span class="op">=</span> <span class="fl">2</span>, nv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#get meanshape</span></span>
<span class="r-in"><span class="va">meanshape</span> <span class="op">&lt;-</span> <span class="fu"><a href="consensus.html">consensus</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">#plot grid (shape coordinates only)</span></span>
<span class="r-in"><span class="fu">plot_morphogrid3d</span><span class="op">(</span>morphogrid <span class="op">=</span> <span class="va">shapes_grid</span>, refshape <span class="op">=</span> <span class="va">meanshape</span>,</span>
<span class="r-in">                  ordtype <span class="op">=</span> <span class="st">"prcomp"</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col.ldm <span class="op">=</span> <span class="fl">1</span>, cex.ldm <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                  col.models <span class="op">=</span> <span class="fl">1</span>, lwd.models <span class="op">=</span> <span class="fl">1</span>, bg.models <span class="op">=</span> <span class="st">"gray"</span>, size.models <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">                  asp.models <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#get shape corresponding to shells3D$mesh_meanspec using geomorph::findMeanSpec,</span></span>
<span class="r-in"><span class="co">#then get mesh corresponding to mean shape using Morpho::tps3d</span></span>
<span class="r-in"><span class="va">meanspec_id</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/findMeanSpec.html" class="external-link">findMeanSpec</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span>
<span class="r-in"><span class="va">meanspec_shape</span> <span class="op">&lt;-</span> <span class="va">shapes</span><span class="op">[</span>,,<span class="va">meanspec_id</span><span class="op">]</span></span>
<span class="r-in"><span class="va">meanmesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Morpho/man/tps3d.html" class="external-link">tps3d</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">mesh_meanspec</span> , refmat <span class="op">=</span> <span class="va">meanspec_shape</span>, tarmat <span class="op">=</span> <span class="va">meanshape</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#plot grid (includinh mesh template)</span></span>
<span class="r-in"><span class="fu">plot_morphogrid3d</span><span class="op">(</span>morphogrid <span class="op">=</span> <span class="va">shapes_grid</span>, template <span class="op">=</span> <span class="va">meanmesh</span>, refshape <span class="op">=</span> <span class="va">meanshape</span>,</span>
<span class="r-in">                  ordtype <span class="op">=</span> <span class="st">"prcomp"</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col.ldm <span class="op">=</span> <span class="fl">1</span>, cex.ldm <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                  col.models <span class="op">=</span> <span class="fl">1</span>, lwd.models <span class="op">=</span> <span class="fl">1</span>, bg.models <span class="op">=</span> <span class="st">"gray"</span>, size.models <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">                  asp.models <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

