<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Performs phylogenetic 2B Partial Least Squares allowing for leave-one-out cross-validation
and removal of phylogenetic covariation (experimental)."><title>Two-blocks Partial Least Squares — pls2b • morphospace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-blocks Partial Least Squares — pls2b"><meta property="og:description" content="Performs phylogenetic 2B Partial Least Squares allowing for leave-one-out cross-validation
and removal of phylogenetic covariation (experimental)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">morphospace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/General-usage.html">General usage</a>
    <a class="dropdown-item" href="../articles/Worked-examples.html">Worked examples</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/millacarmona/morphospace/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Two-blocks Partial Least Squares</h1>
      <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/multivariate_analyses.R" class="external-link"><code>R/multivariate_analyses.R</code></a></small>
      <div class="d-none name"><code>pls2b.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs phylogenetic 2B Partial Least Squares allowing for leave-one-out cross-validation
and removal of phylogenetic covariation (experimental).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pls2b</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, tree <span class="op">=</span> <span class="cn">NULL</span>, LOOCV <span class="op">=</span> <span class="cn">FALSE</span>, recompute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows, representing the first block.</p></dd>
<dt>y</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows, representing the second block.</p></dd>
<dt>tree</dt>
<dd><p>A <code>"phy"</code> object containing a phylogenetic tree. Tip labels
should match the row number and names from <code>x</code> and <code>y</code>.</p></dd>
<dt>LOOCV</dt>
<dd><p>Logical; whether to apply leave-one-out cross-validation.</p></dd>
<dt>recompute</dt>
<dd><p>Logical; whether to re-compute rotation matrix using the
scores resulting from LOOCV.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>"pls2b"</code> or <code>"phy_pls2b"</code> object, containing:</p><ul><li><p><code>$values:</code> vector of singular values accounting for the
covariation among blocks explained by each par of axes.</p></li>
<li><p><code>$xrotation:</code> matrix of vector coefficients for the first
block.</p></li>
<li><p><code>$yrotation:</code> matrix of vector coefficients for the second
block.</p></li>
<li><p><code>$xcenter:</code> the mean values of the original variables from
the first block (or their phylogenetic mean, if <code>tree</code> is
provided).</p></li>
<li><p><code>$ycenter:</code> the mean values of the original variables from
the second block (or their phylogenetic mean, if <code>tree</code> is
provided).</p></li>
<li><p><code>$xtotvar:</code> the sum of the variances from the original
variables from the second block.</p></li>
<li><p><code>$ytotvar:</code> the sum of the variances from the original
variables from the second block.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Starting with two blocks of variables measured for the same
cases, two-blocks PLS finds the linear combination of variables on each
block maximizing covariation with the variables on the other. In the
context of <code>morphospace</code>, one or both of these blocks will usually
be a series of shapes arranged as a 2-margins matrix.</p>
<p>It has been reported that PLS (as an algebraic equivalent of bgPCA)
produces spurious covariation between blocks when the number of variables
exceeds the number of observations (which is a common situation in
geometric morphometrics analyses). This problem can be alleviated by
carrying out a leave-one-out cross-validation (LOOCV; i.e. each
observation is excluded from the calculation of PLS axes before its
projection in the resulting ordination as a way to calculate its score).</p>
<p>If <code>tree</code> is supplied, rows of <code>x</code> and <code>y</code> are assumed to
be linked by those phylogenetic relationships. In this case, the resulting
axes maximize the residual covariation among blocks left after removing
covariation among blocks accounted by phylogenetic history (assuming a
Brownian model of evolution and 100% phylogenetic signal, which is
equivalent to setting <code>method = "BM"</code> in <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>).</p>
<p>The phylogenetic version of <code>pls2b</code> displays the same variational
properties than phylogenetic PCA (i.e. centering on the phylogenetic mean;
orientation of scores reflect non-phylogenetic covariation but their variance
is not scaled and thus contain phylogenetic information; for the latter
reason, variance of scores and eigenvalues differ; scores are correlated; etc;
see Polly et al. 2013).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rohlf, F. J., &amp; Corti, M. (2000). <em>Use of two-block partial
least-squares to study covariation in shape</em>. Systematic Biology, 49(4),
740-753.</p>
<p>Zelditch, M. L., Swiderski, D. L., &amp; Sheets, H. D. (2012). <em>Geometric
morphometrics for biologists: A primer</em>. 2nd ed. Academic
Press.</p>
<p>Polly, P. D., Lawing, A. M., Fabre, A. C., &amp; Goswami, A. (2013).
<em>Phylogenetic principal components analysis and geometric
morphometrics</em>. Hystrix, 24(1), 33.</p>
<p>Monteiro, L. R. (2013). <em>Morphometrics and the comparative method:
studying the evolution of biological shape</em>. Hystrix, the Italian Journal
of Mammalogy, 24(1), 25-32.</p>
<p>Bookstein, F. L. (2019). <em>Pathologies of between-groups principal
components analysis in geometric morphometrics</em>. Evolutionary Biology, 46(4),
271-302.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pls_shapes.html">pls_shapes</a></code>, <code><a href="phy_prcomp.html">phy_prcomp</a></code>,
<code><a href="exp_var.html">exp_var</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#load data and packages</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#extract mean log sizes and shapes for all species, as well as the phylogenetic tree</span></span>
<span class="r-in"><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span>
<span class="r-in"><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">tails</span><span class="op">$</span><span class="va">sizes</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="consensus.html">consensus</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, index <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sp_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">sizes</span>, INDEX <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#perform PLS between shape and size</span></span>
<span class="r-in"><span class="va">pls</span> <span class="op">&lt;-</span> <span class="fu">pls2b</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">sizes</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#look at the results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pls</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yscores"   "yrotation" "ycenter"   "ytotvar"   "xscores"   "xrotation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "xcenter"   "xtotvar"   "values"   </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">pls</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span> <span class="co">#ordination</span></span>
<span class="r-plt img"><img src="pls2b-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#pls_shapes achieves identical results, but it is formatted to be used more</span></span>
<span class="r-in"><span class="co">#easily when analyzing shape variables and its output is compatible with other</span></span>
<span class="r-in"><span class="co">#functions from morphospace</span></span>
<span class="r-in"><span class="va">pls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pls_shapes.html">pls_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, X <span class="op">=</span> <span class="va">sizes</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sdev"     "rotation" "x"        "x2"       "center"   "totvar"  </span>
<span class="r-in"><span class="fu"><a href="exp_var.html">exp_var</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">)</span> <span class="co">#variance explained by each axis</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variance cummulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PLS-1 74.05123    74.05123</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">$</span><span class="va">x2</span>, <span class="va">pls2</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span>
<span class="r-plt img"><img src="pls2b-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#perform phylogenetic PLS</span></span>
<span class="r-in"><span class="va">ppls</span> <span class="op">&lt;-</span> <span class="fu">pls2b</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">sp_shapes</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">sp_sizes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#look at the results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppls</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yscores"   "yrotation" "ycenter"   "ytotvar"   "xscores"   "xrotation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "xcenter"   "xtotvar"   "values"   </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppls</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">ppls</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span> <span class="co">#ordination</span></span>
<span class="r-plt img"><img src="pls2b-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#pls_shapes achieves identical results, but it is formatted to be used more</span></span>
<span class="r-in"><span class="co">#easily when analyzing shape variables and its output is compatible with other</span></span>
<span class="r-in"><span class="co">#functions from morphospace</span></span>
<span class="r-in"><span class="va">ppls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pls_shapes.html">pls_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, X <span class="op">=</span> <span class="va">sp_sizes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sdev"     "rotation" "x"        "x2"       "center"   "totvar"  </span>
<span class="r-in"><span class="fu"><a href="exp_var.html">exp_var</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">)</span> <span class="co">#variance explained by each axis</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          variance cummulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPLS-1 75.04955    75.04955</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">$</span><span class="va">x2</span>, <span class="va">ppls2</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span>
<span class="r-plt img"><img src="pls2b-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

