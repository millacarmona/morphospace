<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-blocks Partial Least Squares — pls2b • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-blocks Partial Least Squares — pls2b"><meta property="og:description" content="Performs 2B Partial Least Squares allowing for leave-one-out cross-validation
and removal of phylogenetic covariation (experimental)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-blocks Partial Least Squares</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/multivariate_analyses.R" class="external-link"><code>R/multivariate_analyses.R</code></a></small>
    <div class="hidden name"><code>pls2b.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs 2B Partial Least Squares allowing for leave-one-out cross-validation
and removal of phylogenetic covariation (experimental).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pls2b</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, tree <span class="op">=</span> <span class="cn">NULL</span>, LOOCV <span class="op">=</span> <span class="cn">FALSE</span>, recompute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows, representing the first block.</p></dd>


<dt>y</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows, representing the second block.</p></dd>


<dt>tree</dt>
<dd><p>A <code>"phylo"</code> object containing a phylogenetic tree. Tip labels
should match the row number and names from <code>x</code> and <code>y</code>.</p></dd>


<dt>LOOCV</dt>
<dd><p>Logical; whether to apply leave-one-out cross-validation.</p></dd>


<dt>recompute</dt>
<dd><p>Logical; whether to re-compute rotation matrix using the
scores resulting from LOOCV.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>"pls2b"</code> or <code>"phy_pls2b"</code> object, containing:</p><ul><li><p><code>$values:</code> vector of singular values accounting for the
covariation among blocks explained by each par of axes.</p></li>
<li><p><code>$xrotation:</code> matrix of vector coefficients for the first
block.</p></li>
<li><p><code>$yrotation:</code> matrix of vector coefficients for the second
block.</p></li>
<li><p><code>$xcenter:</code> the mean values of the original variables from
the first block (or their phylogenetic mean, if <code>tree</code> is
provided).</p></li>
<li><p><code>$ycenter:</code> the mean values of the original variables from
the second block (or their phylogenetic mean, if <code>tree</code> is
provided).</p></li>
<li><p><code>$xtotvar:</code> the sum of the variances from the original
variables from the second block.</p></li>
<li><p><code>$ytotvar:</code> the sum of the variances from the original
variables from the second block.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Starting with two blocks of variables measured for the same
cases, two-blocks PLS finds the linear combination of variables on each
block maximizing covariation with the variables on the other. In the
context of <code>morphospace</code>, one or both of these blocks will usually
be a series of shapes arranged as a 2-margins matrix.</p>
<p>It has been reported that PLS (as an algebraic equivalent of bgPCA)
produces spurious covariation between blocks when the number of variables
exceeds the number of observations (which is a common situation in
geometric morphometrics analyses). This problem can be alleviated by
carrying out a leave-one-out cross-validation (LOOCV; i.e. each
observation is excluded from the calculation of PLS axes before its
projection in the resulting ordination as a way to calculate its score).</p>
<p>If <code>tree</code> is supplied, rows of <code>x</code> and <code>y</code> are assumed to
be linked by those phylogenetic relationships. In this case, the resulting
axes maximize the residual covariation among blocks left after removing
covariation among blocks accounted by phylogenetic history (assuming a
Brownian model of evolution and 100% phylogenetic signal, which is
equivalent to setting <code>method = "BM"</code> in <code><a href="https://rdrr.io/pkg/phytools/man/phyl.pca.html" class="external-link">phytools::phyl.pca()</a></code>).</p>
<p>The phylogenetic version of <code>pls2b()</code> displays the same variational
properties than phylogenetic PCA (i.e. centering on the phylogenetic mean;
orientation of scores reflect non-phylogenetic covariation but their variance
is not scaled and thus contain phylogenetic information; for the latter
reason, variance of scores and eigenvalues differ; scores are correlated; etc;
see Polly et al. 2013).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Rohlf, F. J., &amp; Corti, M. (2000). <em>Use of two-block partial
least-squares to study covariation in shape</em>. Systematic Biology, 49(4),
740-753.</p>
<p>Zelditch, M. L., Swiderski, D. L., &amp; Sheets, H. D. (2012). <em>Geometric
morphometrics for biologists: A primer</em>. 2nd ed. Academic
Press.</p>
<p>Polly, P. D., Lawing, A. M., Fabre, A. C., &amp; Goswami, A. (2013).
<em>Phylogenetic principal components analysis and geometric
morphometrics</em>. Hystrix, 24(1), 33.</p>
<p>Monteiro, L. R. (2013). <em>Morphometrics and the comparative method:
studying the evolution of biological shape</em>. Hystrix, the Italian Journal
of Mammalogy, 24(1), 25-32.</p>
<p>Bookstein, F. L. (2019). <em>Pathologies of between-groups principal
components analysis in geometric morphometrics</em>. Evolutionary Biology, 46(4),
271-302.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="pls_shapes.html">pls_shapes</a></code>, <code><a href="phy_prcomp.html">phy_prcomp</a></code>,
<code><a href="exp_var.html">exp_var</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#load data and packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#extract mean log sizes and shapes for all species, as well as the phylogenetic tree</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">tails</span><span class="op">$</span><span class="va">sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, x <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">sizes</span>, INDEX <span class="op">=</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#perform PLS between shape and size</span></span></span>
<span class="r-in"><span><span class="va">pls</span> <span class="op">&lt;-</span> <span class="fu">pls2b</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#look at the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pls</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yscores"   "yrotation" "ycenter"   "ytotvar"   "xscores"   "xrotation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "xcenter"   "xtotvar"   "values"   </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">pls</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="pls2b-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#pls_shapes achieves identical results, but it is formatted to be used more</span></span></span>
<span class="r-in"><span><span class="co">#easily when analyzing shape variables and its output is compatible with other</span></span></span>
<span class="r-in"><span><span class="co">#functions from morphospace</span></span></span>
<span class="r-in"><span><span class="va">pls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pls_shapes.html">pls_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">shapes</span>, X <span class="op">=</span> <span class="va">sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sdev"     "rotation" "x"        "x2"       "center"   "totvar"  </span>
<span class="r-in"><span><span class="fu"><a href="exp_var.html">exp_var</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">)</span> <span class="co">#variance explained by each axis</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variance cummulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PLS-1 74.05123    74.05123</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pls2</span><span class="op">$</span><span class="va">x2</span>, <span class="va">pls2</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="pls2b-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#perform phylogenetic PLS</span></span></span>
<span class="r-in"><span><span class="va">ppls</span> <span class="op">&lt;-</span> <span class="fu">pls2b</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">sp_shapes</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">sp_sizes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#look at the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppls</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yscores"   "yrotation" "ycenter"   "ytotvar"   "xscores"   "xrotation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "xcenter"   "xtotvar"   "values"   </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppls</span><span class="op">$</span><span class="va">xscores</span>, <span class="va">ppls</span><span class="op">$</span><span class="va">yscores</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="pls2b-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#pls_shapes achieves identical results, but it is formatted to be used more</span></span></span>
<span class="r-in"><span><span class="co">#easily when analyzing shape variables and its output is compatible with other</span></span></span>
<span class="r-in"><span><span class="co">#functions from morphospace</span></span></span>
<span class="r-in"><span><span class="va">ppls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pls_shapes.html">pls_shapes</a></span><span class="op">(</span>shapes <span class="op">=</span> <span class="va">sp_shapes</span>, X <span class="op">=</span> <span class="va">sp_sizes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sdev"     "rotation" "x"        "x2"       "center"   "totvar"  </span>
<span class="r-in"><span><span class="fu"><a href="exp_var.html">exp_var</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">)</span> <span class="co">#variance explained by each axis</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          variance cummulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyPLS-1 75.04955    75.04955</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppls2</span><span class="op">$</span><span class="va">x2</span>, <span class="va">ppls2</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="pls2b-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

