<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate morphospace — mspace • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate morphospace — mspace"><meta property="og:description" content="Create an empirical morphospace as an ordination comprising a set
of axes synthesizing shape variation. Allows a variety of multivariate methods
for building the ordination."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate morphospace</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/mspace_workflow.R" class="external-link"><code>R/mspace_workflow.R</code></a></small>
    <div class="hidden name"><code>mspace.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an empirical morphospace as an ordination comprising a set
of axes synthesizing shape variation. Allows a variety of multivariate methods
for building the ordination.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mspace</span><span class="op">(</span></span>
<span>  <span class="va">shapes</span>,</span>
<span>  axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  links <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  FUN <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span>,</span>
<span>  nh <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  nv <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  mag <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  invax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  asp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adj_frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  rot.models <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  size.models <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  asp.models <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.models <span class="op">=</span> <span class="st">"#708095"</span>,</span>
<span>  bg.models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lwd.models <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha.models <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.ldm <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.ldm <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  models <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>shapes</dt>
<dd><p>Shapes data.</p></dd>


<dt>axes</dt>
<dd><p>Numeric of length 2, indicating the axes to be plotted.</p></dd>


<dt>links</dt>
<dd><p>A list with the indices of the coordinates defining the
wireframe (following the format used in <code>Morpho</code>).</p></dd>


<dt>template</dt>
<dd><p>Either a 2-column matrix containing landmarks/semilandmarks
followed by coordinates defining a curve or set of curves describing additional
aspects of morphology (for 2D shape data) or a <code>"mesh3d"</code> object containing
geometry of the structure the landmarks were placed on (for 3D shape data),
corresponding to the mean shape of the sample. These will be warped using TPS
interpolation to produce the set of background shell models (see
<code><a href="build_template2d.html">build_template2d</a></code>).</p></dd>


<dt>p</dt>
<dd><p>Numeric, indicating the number of landmarks/semilandmarks used (for
landmark data only).</p></dd>


<dt>k</dt>
<dd><p>Numeric, indicating the number of cartesian dimensions of
landmarks/semilandmarks (for landmark data only).</p></dd>


<dt>FUN</dt>
<dd><p>The function to be used for synthesizing geometric morphometric
variation. Usual alternatives include <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>,
<code><a href="bg_prcomp.html">bg_prcomp</a></code> and <code><a href="phy_prcomp.html">phy_prcomp</a></code>.</p></dd>


<dt>nh</dt>
<dd><p>Numeric; number of shape models along the x axis.</p></dd>


<dt>nv</dt>
<dd><p>Numeric; number of shape models along the y axis.</p></dd>


<dt>mag</dt>
<dd><p>Numeric; magnifying factor for shape models.</p></dd>


<dt>invax</dt>
<dd><p>Optional numeric indicating which of the axes provided in
<code>axes</code> needs to be inverted (optionsare <code>1</code>, <code>2</code> or
<code>c(1,2)</code>).</p></dd>


<dt>xlim, ylim, xlab, ylab, asp</dt>
<dd><p>Standard arguments passed to the generic plot
function.</p></dd>


<dt>adj_frame</dt>
<dd><p>Numeric of length 2, providing <em>a posteriori</em> scaling
factors for the width and height of the frame, respectively.</p></dd>


<dt>rot.models</dt>
<dd><p>Numeric; angle (in degrees) to rotate shape models.</p></dd>


<dt>size.models</dt>
<dd><p>Numeric; size factor for shape models.</p></dd>


<dt>asp.models</dt>
<dd><p>Numeric; the y/x aspect ratio of shape models.</p></dd>


<dt>col.models</dt>
<dd><p>Color for wireframes/outlines.</p></dd>


<dt>bg.models</dt>
<dd><p>Background color for outlines/meshes.</p></dd>


<dt>lwd.models</dt>
<dd><p>Numeric; width of the lines in wireframes/outlines.</p></dd>


<dt>alpha.models</dt>
<dd><p>Numeric; transparency factor for background models (3D only).</p></dd>


<dt>points</dt>
<dd><p>Logical; whether to plot the scatter points.</p></dd>


<dt>cex.ldm</dt>
<dd><p>Numeric; size of landmarks/semilandmarks in the background
models.</p></dd>


<dt>col.ldm</dt>
<dd><p>Color of landmarks/semilandmarks in the background models.</p></dd>


<dt>plot</dt>
<dd><p>Logical; whether to plot morphospace.</p></dd>


<dt>models</dt>
<dd><p>Logical; whether to plot background shape models.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to <code>FUN</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"mspace"</code>, which is a list containing:</p><ul><li><p>$ordtype:  method used for multivariate ordination.</p></li>
<li><p>$datype:  type of shape data used.</p></li>
<li><p>$x:  scores of the sample of shapes in the synthetic axes.</p></li>
<li><p>$rotation:  eigenvector's coefficients.</p></li>
<li><p>$center:  the mean values of the original shape variables.</p></li>
<li><p>$plotinfo:  a list with the information used to create the plot.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is the central piece of the <code>morphospace</code> workflow.
It produces a synthetic space from a sample of normalized shapes using
eigenanalysis-based ordination methods (PCA, between groups PCA, two-block
PLS, and their phylogenetic versions) and generates shape models depicting
the range of realized variation, retaining the information necessary to
project and retrieve new compatible shapes. The output of <code>mspace</code> is
meant to be expanded using the <code>proj_*</code> family of functions and the
<code>%&gt;%</code> operator from <code>magrittr</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="proj_shapes.html">proj_shapes</a></code>, <code><a href="proj_consensus.html">proj_consensus</a></code>,
<code><a href="proj_groups.html">proj_groups</a></code>, <code><a href="proj_phylogeny.html">proj_phylogeny</a></code>,
<code><a href="proj_axis.html">proj_axis</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##2D Landmark data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#load and extract relevant data and information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span></span>
<span class="r-in"><span><span class="va">links</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using the basic sample of shapes, PCA as ordination method</span></span></span>
<span class="r-in"><span><span class="co">#and the links between landmarks provided for backround models</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, mag <span class="op">=</span> <span class="fl">0.7</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#increase magnification factor x2:</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot PCs 1 and 3</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, mag <span class="op">=</span> <span class="fl">1.5</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using the basic sample of shapes, bgPCA as ordination method</span></span></span>
<span class="r-in"><span><span class="co">#and links between landmarks for backround models</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, FUN <span class="op">=</span> <span class="va">bg_prcomp</span>, groups <span class="op">=</span> <span class="va">species</span>, mag <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>       axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, invax <span class="op">=</span> <span class="fl">1</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using species' consensus shapes and phylogenetic tree,</span></span></span>
<span class="r-in"><span><span class="co">#phylogenetic PCA as ordination method, and links between landmarks for backround</span></span></span>
<span class="r-in"><span><span class="co">#models</span></span></span>
<span class="r-in"><span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span><span class="va">shapes</span>, <span class="va">species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">sp_shapes</span>, links <span class="op">=</span> <span class="va">links</span>, FUN <span class="op">=</span> <span class="va">phy_prcomp</span>, tree <span class="op">=</span> <span class="va">tree</span>, mag <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>       axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#just create a morphospace without plotting, save into an object, and inspect</span></span></span>
<span class="r-in"><span><span class="va">morphosp</span> <span class="op">&lt;-</span> <span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, mag <span class="op">=</span> <span class="fl">0.7</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">morphosp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"        "rotation" "center"   "datype"   "ordtype"  "plotinfo"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#load wing data for a quick demo with templates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wings"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">wings</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">links</span> <span class="op">&lt;-</span> <span class="va">wings</span><span class="op">$</span><span class="va">links</span></span></span>
<span class="r-in"><span><span class="va">template</span> <span class="op">&lt;-</span> <span class="va">wings</span><span class="op">$</span><span class="va">template</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using links</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, links <span class="op">=</span> <span class="va">links</span>, mag <span class="op">=</span> <span class="fl">3</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in shapes_mat(shapes):</span> object 'data2d' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using template</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, template <span class="op">=</span> <span class="va">template</span>, mag <span class="op">=</span> <span class="fl">3</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in shapes_mat(shapes):</span> object 'data2d' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##3D Landmark data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#load data and packages and extract relevant data and information</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zarquon42b/Morpho" class="external-link">Morpho</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"shells3D"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">mesh_meanspec</span> <span class="op">&lt;-</span> <span class="va">shells3D</span><span class="op">$</span><span class="va">mesh_meanspec</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace. This is interactive, you need to rotate the shape by yourself and</span></span></span>
<span class="r-in"><span><span class="co">#then press enter into the console.</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, mag <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col.ldm <span class="op">=</span> <span class="st">"black"</span>, cex.ldm <span class="op">=</span> <span class="fl">2</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using a mesh template that improves visualization:</span></span></span>
<span class="r-in"><span><span class="co">#first, get shape corresponding to shells3D$mesh_meanspec using geomorph::findMeanSpec</span></span></span>
<span class="r-in"><span><span class="va">meanspec_id</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/findMeanSpec.html" class="external-link">findMeanSpec</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meanspec_shape</span> <span class="op">&lt;-</span> <span class="va">shapes</span><span class="op">[</span>,,<span class="va">meanspec_id</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#then get the consensus shape and warp the sample mesh to get the mesh corresponding to the</span></span></span>
<span class="r-in"><span><span class="co">#consensus using Morpho::tps3d</span></span></span>
<span class="r-in"><span><span class="va">meanshape</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span><span class="va">shapes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meanmesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Morpho/man/tps3d.html" class="external-link">tps3d</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mesh_meanspec</span> , refmat <span class="op">=</span> <span class="va">meanspec_shape</span>, tarmat <span class="op">=</span> <span class="va">meanshape</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#finally, generate morphospace providing template (this function used the mesh warped to</span></span></span>
<span class="r-in"><span><span class="co">#the mean shape of the entire sample, hence the previous lines)</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, mag <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, template <span class="op">=</span> <span class="va">meanmesh</span>, bg.models <span class="op">=</span> <span class="st">"gray"</span>,</span></span>
<span class="r-in"><span>       nh <span class="op">=</span> <span class="fl">4</span>, nv <span class="op">=</span> <span class="fl">4</span>, cex.ldm <span class="op">=</span> <span class="fl">0</span>, points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Outline data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#load and extract relevant data and information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"shells"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">shells</span><span class="op">$</span><span class="va">shapes</span><span class="op">$</span><span class="va">coe</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate morphospace using all the raw variation</span></span></span>
<span class="r-in"><span><span class="fu">mspace</span><span class="op">(</span><span class="va">shapes</span>, mag <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, nh <span class="op">=</span> <span class="fl">5</span>, nv <span class="op">=</span> <span class="fl">4</span>, size.models <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>       asp.models <span class="op">=</span> <span class="fl">1</span>, bg.model <span class="op">=</span> <span class="st">"light gray"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mspace-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

