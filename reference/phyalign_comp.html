<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phylogenetically Aligned Component Analysis — phyalign_comp • morphospace</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetically Aligned Component Analysis — phyalign_comp"><meta property="og:description" content="Performs Phylogenetically Aligned Component Analysis (PACA).
Experimental."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphospace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/General-usage.html">General usage</a>
    </li>
    <li>
      <a href="../articles/Worked-examples.html">Worked examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/millacarmona/morphospace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phylogenetically Aligned Component Analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/millacarmona/morphospace/blob/HEAD/R/multivariate_analyses.R" class="external-link"><code>R/multivariate_analyses.R</code></a></small>
    <div class="hidden name"><code>phyalign_comp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs Phylogenetically Aligned Component Analysis (PACA).
Experimental.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">phyalign_comp</span><span class="op">(</span><span class="va">x</span>, <span class="va">tree</span>, corr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A matrix with one or more variables as columns and observations as
rows. Rows must be named and match tip labels from the phylogenetic
<code>tree</code>.</p></dd>


<dt>tree</dt>
<dd><p>A <code>"phylo"</code> object containing a phylogenetic tree. Tip
labels should match the row names from <code>x</code>.</p></dd>


<dt>corr</dt>
<dd><p>Logical; whether to use correlation instead of covariance matrix
as input.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>"phyalign_comp"</code> object formatted following the
<code>"prcomp"</code> class:</p><ul><li><p><code>$x:</code> a matrix with the scores of observations in the new
ordination axes.</p></li>
<li><p><code>$values:</code> squared, sample size-corrected singular values from
the SVD of the cross product of the phylogenetic covariance matrix and
trait data.</p></li>
<li><p><code>$rotation:</code> a matrix of eigenvector coefficients.</p></li>
<li><p><code>$center:</code> the phylogenetic mean (i.e., the shape estimated
for the root of the tree).</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Phylogenetically aligned component analysis (PACA) finds a new set
of axes as linear combinations of the original trait variables that are
maximally aligned with the phylogenetic signal (i.e., covariation between
trait variation and phylogenetic structure) present in the data.</p>
<p>PACA shares some important properties with phylogenetic PCA that are worth
having in mind. Most importantly, the transformation achieved by PACA to
maximize alignment to phylogenetic signal only concerns the orientation of
the new axes (PACs), and not their overall dispersion (i.e., Euclidean
distances among observations are preserved when measured across the entire
set of PACs). Like phylogenetic PCA, scores projected into the different
PACs can be correlated (even though singular vectors are orthogonal), and
their dispersion does not necessarily decrease for lower axes (even though
singular values do progressively decay). Also, A phylogenetic covariance
matrix is computed assuming a Brownian model of trait evolution, and the
ordination is centered around the phylogenetic mean (i.e., the root of the
phylogenetic tree).</p>
<p>This analysis produces the same number of axes than the number of original
variables. Again similar to phylogenetic PCA, interpretation of ordination
axes' singular values is complex: they represent the amount of covariation
between phylogenetic structure and trait variation accounted by each axis,
with a scale that is related to branch lengths' units, and thus cannot be
directly interpreted as proportion of the original variance.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Collyer, M. L., &amp; Adams, D. (2021). <em>Phylogenetically aligned component
analysis</em>. Methods in Ecology and Evolution, 12(2), 359-372.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/geomorph/man/gm.prcomp.html" class="external-link">gm.prcomp</a></code>, <code><a href="phy_prcomp.html">phy_prcomp</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#load packaes and data: shapes, species, links and tree</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph" class="external-link">geomorph</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tails"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">shapes</span></span></span>
<span class="r-in"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">species</span></span></span>
<span class="r-in"><span><span class="va">links</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">links</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">tails</span><span class="op">$</span><span class="va">tree</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#extract species shapes</span></span></span>
<span class="r-in"><span><span class="va">sp_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="expected_shapes.html">expected_shapes</a></span><span class="op">(</span><span class="va">shapes</span>, <span class="va">species</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#perform phylogenetically aligned component analysis</span></span></span>
<span class="r-in"><span><span class="va">paca</span> <span class="op">&lt;-</span> <span class="fu">phyalign_comp</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/two.d.array.html" class="external-link">two.d.array</a></span><span class="op">(</span><span class="va">sp_shapes</span><span class="op">)</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#inspect results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">paca</span><span class="op">)</span> <span class="co">#the contents of the resulting object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "values"   "rotation" "x"        "center"  </span>
<span class="r-in"><span><span class="co">#exp_var(paca) #interpretation of eigenvalues is complex! not yet implemented</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#ordination</span></span></span>
<span class="r-plt img"><img src="phyalign_comp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare shape variation as summarized by different methods</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#build morphospace using phylogenetically aligned components analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mspace.html">mspace</a></span><span class="op">(</span><span class="va">sp_shapes</span>, links <span class="op">=</span> <span class="va">links</span>, nh <span class="op">=</span> <span class="fl">8</span>, nv <span class="op">=</span> <span class="fl">6</span>, FUN <span class="op">=</span> <span class="va">phyalign_comp</span>,</span></span>
<span class="r-in"><span>       tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span><span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="phyalign_comp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare against morphospace built with ordinary PCA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mspace.html">mspace</a></span><span class="op">(</span><span class="va">sp_shapes</span>, links <span class="op">=</span> <span class="va">links</span>, nh <span class="op">=</span> <span class="fl">8</span>, nv <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="proj_phylogeny.html">proj_phylogeny</a></span><span class="op">(</span><span class="va">sp_shapes</span>, tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="phyalign_comp-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Milla Carmona.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

