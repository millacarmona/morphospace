% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mspace_workflow.R
\name{proj_shapes}
\alias{proj_shapes}
\title{Project shapes into morphospace}
\usage{
proj_shapes(mspace, shapes, density = TRUE, labels = NULL, pipe = TRUE, ...)
}
\arguments{
\item{mspace}{An \code{"mspace"} object.}

\item{shapes}{Shape data.}

\item{density}{Logical; whether to add density distribution for points}

\item{labels}{Either logical, indicating whether to include all point labels,
or a character string with the exact names of the points whose labels
should be included.
(univariate ordinations only).}

\item{pipe}{Logical; is the function being included in a pipe?}

\item{...}{Further arguments passed to \code{\link[graphics:points]{graphics::points()}}.}
}
\value{
If a plot device with a morphospace is open, shapes fed to
\code{shapes} are projected into morphospace. If \code{pipe = FALSE}
those scores are returned invisibly. If \code{pipe = TRUE} the supplied
\code{"mspace"} object will be modified by appending a \code{$scores} slot
to \code{$projected} and adding some graphical parameters (stored into the
\code{$plotinfo} slot), and returned invisibly.
}
\description{
Project a set of shapes as scatterpoints into an existing
morphospace.
}
\details{
The purpose of this function is to maintain morphospace building
and sample representation as separated steps, as well as to add flexibility
to graphical representation of scatterpoints.
}
\examples{
#load and extract relevant data, packages and information
library(magrittr)
data("wings")
shapes <- wings$shapes
cactus <- wings$data$sex
species <- wings$data$species
template <- wings$template

#generate basic morphospace, add sampled shapes
mspace(shapes, template = template, mag = 0.7, axes = c(1,2)) \%>\%
  proj_shapes(shapes = shapes)

#change colors, symbols, etc for the scatter
mspace(shapes, template = template, mag = 0.7, axes = c(1,2)) \%>\%
  proj_shapes(shapes = shapes[,,species == "Db"],  col = c("green"),
              pch = c(1,16)[cactus[species == "Db"]]) \%>\%
  proj_shapes(shapes = shapes[,,species == "Dk"],  col = c("blue"),
              pch = c(1,16)[cactus[species == "Dk"]])

#add labels for all the points (needs a named 'shapes' object)
mspace(shapes, template = template, mag = 0.7, axes = c(1,2)) \%>\%
  proj_shapes(shapes = shapes, labels = TRUE)

#add labels for selected points (needs a named 'shapes' object)
mspace(shapes, template = template, mag = 0.7, axes = c(1,2)) \%>\%
  proj_shapes(shapes = shapes) \%>\%
  proj_shapes(shapes = shapes[,,c("Dk M Op 8 Ad_02", "Dk H Tr 11 Ad_03")],
              pch = 16, col = 2, labels = c("Dk M Op 8 Ad_02", "Dk H Tr 11 Ad_03"))
}
